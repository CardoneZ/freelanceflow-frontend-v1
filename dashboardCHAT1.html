<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FreelanceFlow - Professional Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .smooth-transition { transition: all 0.3s ease; }
        .sidebar { transition: transform 0.3s ease; }
        @media (max-width: 768px) {
            .sidebar { 
                transform: translateX(-100%); 
                position: fixed; 
                z-index: 50; 
                height: 100vh; 
            }
            .sidebar.open { transform: translateX(0); }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Navbar -->
    <nav class="bg-white shadow-sm fixed w-full z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <button id="mobile-menu-button" class="md:hidden text-gray-500 hover:text-gray-700">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    <div class="flex-shrink-0 flex items-center">
                        <img class="h-8 w-auto" src="/assets/images/logo.png" alt="FreelanceFlow">
                    </div>
                </div>
                <div class="flex items-center">
                    <div class="ml-4 flex items-center md:ml-6">
                        <button type="button" class="bg-white p-1 rounded-full text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                            <span class="sr-only">View notifications</span>
                            <div class="relative">
                                <i class="far fa-bell text-xl"></i>
                                <span class="absolute -top-1 -right-1 h-4 w-4 rounded-full bg-red-500 text-white text-xs flex items-center justify-center">3</span>
                            </div>
                        </button>

                        <!-- Profile dropdown -->
                        <div class="ml-3 relative">
                            <div>
                                <button id="user-menu-button" class="max-w-xs bg-white flex items-center text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                    <span class="sr-only">Open user menu</span>
                                    <img class="h-8 w-8 rounded-full" id="user-avatar-img" src="https://ui-avatars.com/api/?background=667eea&color=fff&name=JD" alt="">
                                    <span class="ml-2 hidden md:inline-block" id="user-name">Loading...</span>
                                </button>
                            </div>
                            <div class="origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 focus:outline-none hidden" role="menu">
                                <a href="profile.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Your Profile</a>
                                <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Settings</a>
                                <a href="#" id="logout-btn" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Sign out</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Sidebar -->
    <div class="sidebar bg-white w-64 fixed h-full shadow-md overflow-y-auto">
        <div class="flex items-center justify-center h-16 border-b">
            <span class="text-xl font-semibold text-gray-700">FreelanceFlow</span>
        </div>
        <div class="mt-6 px-4">
            <div class="flex items-center px-4 py-3 bg-indigo-50 rounded-lg">
                <img class="h-10 w-10 rounded-full" id="sidebar-user-avatar" src="https://ui-avatars.com/api/?background=667eea&color=fff&name=JD" alt="">
                <div class="ml-3">
                    <p class="text-sm font-medium text-gray-700" id="sidebar-user-name">Loading...</p>
                    <p class="text-xs text-gray-500">Professional</p>
                </div>
            </div>
        </div>
        <nav class="mt-6">
            <div>
                <a href="dashboard.html" class="flex items-center px-6 py-3 text-sm font-medium text-indigo-700 bg-indigo-50 border-l-4 border-indigo-500">
                    <i class="fas fa-tachometer-alt mr-3 text-indigo-500"></i>
                    Dashboard
                </a>
                <a href="appointments.html" class="flex items-center px-6 py-3 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50">
                    <i class="far fa-calendar-alt mr-3 text-gray-500"></i>
                    Appointments
                </a>
                <a href="clients.html" class="flex items-center px-6 py-3 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50">
                    <i class="fas fa-users mr-3 text-gray-500"></i>
                    Clients
                </a>
                <a href="services.html" class="flex items-center px-6 py-3 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50">
                    <i class="fas fa-tasks mr-3 text-gray-500"></i>
                    Services
                </a>
                <a href="availability.html" class="flex items-center px-6 py-3 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50">
                    <i class="far fa-clock mr-3 text-gray-500"></i>
                    Availability
                </a>
                <a href="reviews.html" class="flex items-center px-6 py-3 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50">
                    <i class="far fa-star mr-3 text-gray-500"></i>
                    Reviews
                </a>
            </div>
            <div class="px-6 py-4 border-t mt-4">
                <p class="text-xs font-medium text-gray-500 uppercase tracking-wider">Settings</p>
                <a href="profile.html" class="flex items-center px-2 py-2 mt-2 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-md">
                    <i class="fas fa-user mr-3 text-gray-500"></i>
                    Profile
                </a>
                <a href="#" class="flex items-center px-2 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-md">
                    <i class="fas fa-cog mr-3 text-gray-500"></i>
                    Settings
                </a>
                <a href="#" id="sidebar-logout-btn" class="flex items-center px-2 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-md">
                    <i class="fas fa-sign-out-alt mr-3 text-gray-500"></i>
                    Sign Out
                </a>
            </div>
        </nav>
    </div>

    <!-- Main Content -->
    <div class="md:ml-64 pt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 md:px-8">
            <!-- Page Heading -->
            <div class="py-6">
                <h1 class="text-2xl font-semibold text-gray-900">Dashboard</h1>
                <p class="mt-1 text-sm text-gray-500" id="welcome-message">Welcome back! Here's what's happening today.</p>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4 mb-8" id="stats-cards">
                <!-- Stats will be loaded here -->
                <div class="bg-white p-4 rounded-lg shadow text-center">
                    <div class="animate-pulse flex space-x-4">
                        <div class="flex-1 space-y-4 py-1">
                            <div class="h-4 bg-gray-200 rounded w-3/4 mx-auto"></div>
                            <div class="h-6 bg-gray-200 rounded w-1/2 mx-auto"></div>
                        </div>
                    </div>
                </div>
                <div class="bg-white p-4 rounded-lg shadow text-center">
                    <div class="animate-pulse flex space-x-4">
                        <div class="flex-1 space-y-4 py-1">
                            <div class="h-4 bg-gray-200 rounded w-3/4 mx-auto"></div>
                            <div class="h-6 bg-gray-200 rounded w-1/2 mx-auto"></div>
                        </div>
                    </div>
                </div>
                <div class="bg-white p-4 rounded-lg shadow text-center">
                    <div class="animate-pulse flex space-x-4">
                        <div class="flex-1 space-y-4 py-1">
                            <div class="h-4 bg-gray-200 rounded w-3/4 mx-auto"></div>
                            <div class="h-6 bg-gray-200 rounded w-1/2 mx-auto"></div>
                        </div>
                    </div>
                </div>
                <div class="bg-white p-4 rounded-lg shadow text-center">
                    <div class="animate-pulse flex space-x-4">
                        <div class="flex-1 space-y-4 py-1">
                            <div class="h-4 bg-gray-200 rounded w-3/4 mx-auto"></div>
                            <div class="h-6 bg-gray-200 rounded w-1/2 mx-auto"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Left Column -->
                <div class="lg:col-span-2 space-y-8">
                    <!-- Upcoming Appointments -->
                    <div class="bg-white shadow rounded-lg overflow-hidden">
                        <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                            <h3 class="text-lg leading-6 font-medium text-gray-900">
                                Upcoming Appointments
                            </h3>
                            <p class="mt-1 text-sm text-gray-500">
                                Your next 5 appointments
                            </p>
                        </div>
                        <div class="bg-white overflow-hidden">
                            <ul class="divide-y divide-gray-200" id="upcoming-appointments">
                                <li class="p-4 text-center text-gray-500">
                                    Loading appointments...
                                </li>
                            </ul>
                        </div>
                        <div class="px-4 py-4 bg-gray-50 text-right sm:px-6">
                            <a href="appointments.html" class="inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                View All Appointments
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Right Column -->
                <div class="space-y-8">
                    <!-- Recent Reviews -->
                    <div class="bg-white shadow rounded-lg overflow-hidden">
                        <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                            <h3 class="text-lg leading-6 font-medium text-gray-900">
                                Recent Reviews
                            </h3>
                            <p class="mt-1 text-sm text-gray-500">
                                What your clients are saying
                            </p>
                        </div>
                        <div class="bg-white overflow-hidden">
                            <ul class="divide-y divide-gray-200" id="recent-reviews">
                                <li class="p-4 text-center text-gray-500">
                                    Loading reviews...
                                </li>
                            </ul>
                        </div>
                        <div class="px-4 py-4 bg-gray-50 text-right sm:px-6">
                            <a href="reviews.html" class="inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                View All Reviews
                            </a>
                        </div>
                    </div>

                    <!-- My Services -->
                    <div class="bg-white shadow rounded-lg overflow-hidden">
                        <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                            <div class="flex items-center justify-between">
                                <h3 class="text-lg leading-6 font-medium text-gray-900">
                                    My Services
                                </h3>
                                <a href="services.html" class="inline-flex items-center px-3 py-1 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                                    <i class="fas fa-plus mr-1"></i> Manage Services
                                </a>
                            </div>
                            <p class="mt-1 text-sm text-gray-500">
                                Services you offer to clients
                            </p>
                        </div>
                        <div class="bg-white overflow-hidden">
                            <ul class="divide-y divide-gray-200" id="my-services">
                                <li class="p-4 text-center text-gray-500">
                                    Loading services...
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { professionalsAPI, servicesAPI, appointmentsAPI, reviewsAPI } from '../../../assets/js/api.js';
        import { getCurrentUser, logout } from '../../../assets/js/auth.js';
        import { formatDate, formatTime } from '../../../assets/js/utils.js';

        // DOM Ready
        document.addEventListener('DOMContentLoaded', async function() {
            // Initialize UI components
            initMobileMenu();
            initUserDropdown();
            
            // Load user data
            await loadUserData();
            
            // Load dashboard content
            await loadDashboardStats();
            await loadUpcomingAppointments();
            await loadProfessionalReviews();
            await loadProfessionalServices();
        });

        // Initialize mobile menu toggle
        function initMobileMenu() {
            document.getElementById('mobile-menu-button').addEventListener('click', function() {
                document.querySelector('.sidebar').classList.toggle('open');
            });
        }

        // Initialize user dropdown toggle
        function initUserDropdown() {
            document.getElementById('user-menu-button').addEventListener('click', function() {
                document.querySelector('[role="menu"]').classList.toggle('hidden');
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function(event) {
                if (!event.target.closest('#user-menu-button') && !event.target.closest('[role="menu"]')) {
                    document.querySelector('[role="menu"]').classList.add('hidden');
                }
            });
            
            // Logout handlers
            document.getElementById('logout-btn').addEventListener('click', logout);
            document.getElementById('sidebar-logout-btn').addEventListener('click', logout);
        }

        // Load user data
        async function loadUserData() {
            try {
                const user = getCurrentUser();
                if (!user) {
                    window.location.href = '/login.html';
                    return;
                }

                // Update UI with user data
                document.getElementById('user-name').textContent = `${user.FirstName} ${user.LastName}`;
                document.getElementById('sidebar-user-name').textContent = `${user.FirstName} ${user.LastName}`;
                document.getElementById('welcome-message').textContent = `Welcome back, ${user.FirstName}!`;
                
                // Set avatar
                const avatarUrl = user.profilePicture || `https://ui-avatars.com/api/?background=667eea&color=fff&name=${user.FirstName[0]}+${user.LastName[0]}`;
                document.getElementById('user-avatar-img').src = avatarUrl;
                document.getElementById('sidebar-user-avatar').src = avatarUrl;
                
                return user.UserId;
            } catch (error) {
                console.error('Error loading user data:', error);
                showToast('Failed to load user data', 'error');
            }
        }

        // Load dashboard stats
        async function loadDashboardStats() {
            try {
                const stats = await professionalsAPI.getStats(1); // TODO: Replace with actual professional ID
                
                // Render stats cards
                const statsContainer = document.getElementById('stats-cards');
                statsContainer.innerHTML = `
                    <!-- Total Appointments -->
                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="px-4 py-5 sm:p-6">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 bg-indigo-500 rounded-md p-3">
                                    <i class="fas fa-calendar-alt text-white"></i>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dt class="text-sm font-medium text-gray-500 truncate">
                                        Total Appointments
                                    </dt>
                                    <dd class="flex items-baseline">
                                        <div class="text-2xl font-semibold text-gray-900">
                                            ${stats.totalAppointments || 0}
                                        </div>
                                    </dd>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Earnings -->
                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="px-4 py-5 sm:p-6">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 bg-green-500 rounded-md p-3">
                                    <i class="fas fa-dollar-sign text-white"></i>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dt class="text-sm font-medium text-gray-500 truncate">
                                        Total Earnings
                                    </dt>
                                    <dd class="flex items-baseline">
                                        <div class="text-2xl font-semibold text-gray-900">
                                            $${stats.totalEarnings ? stats.totalEarnings.toFixed(2) : '0.00'}
                                        </div>
                                    </dd>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Average Rating -->
                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="px-4 py-5 sm:p-6">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 bg-yellow-500 rounded-md p-3">
                                    <i class="fas fa-star text-white"></i>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dt class="text-sm font-medium text-gray-500 truncate">
                                        Average Rating
                                    </dt>
                                    <dd class="flex items-baseline">
                                        <div class="text-2xl font-semibold text-gray-900">
                                            ${stats.averageRating ? stats.averageRating.toFixed(1) : '0.0'}
                                        </div>
                                        <div class="flex ml-2">
                                            ${renderStars(stats.averageRating || 0)}
                                        </div>
                                    </dd>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Upcoming Appointments -->
                    <div class="bg-white overflow-hidden shadow rounded-lg">
                        <div class="px-4 py-5 sm:p-6">
                            <div class="flex items-center">
                                <div class="flex-shrink-0 bg-blue-500 rounded-md p-3">
                                    <i class="fas fa-clock text-white"></i>
                                </div>
                                <div class="ml-5 w-0 flex-1">
                                    <dt class="text-sm font-medium text-gray-500 truncate">
                                        Upcoming Today
                                    </dt>
                                    <dd class="text-2xl font-semibold text-gray-900">
                                        ${stats.upcomingToday || 0}
                                    </dd>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } catch (error) {
                console.error('Error loading dashboard stats:', error);
                document.getElementById('stats-cards').innerHTML = `
                    <div class="col-span-4 bg-white p-4 rounded-lg shadow text-center text-red-500">
                        Error loading statistics. Please try again later.
                    </div>
                `;
            }
        }

        // Helper function to render star ratings
        function renderStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            let stars = '';
            
            for (let i = 1; i <= 5; i++) {
                if (i <= fullStars) {
                    stars += '<i class="fas fa-star text-yellow-400"></i>';
                } else if (i === fullStars + 1 && hasHalfStar) {
                    stars += '<i class="fas fa-star-half-alt text-yellow-400"></i>';
                } else {
                    stars += '<i class="far fa-star text-yellow-400"></i>';
                }
            }
            
            return stars;
        }

        // Load upcoming appointments
        async function loadUpcomingAppointments() {
            try {
                const appointments = await appointmentsAPI.getUpcoming();
                
                const container = document.getElementById('upcoming-appointments');
                
                if (appointments.length === 0) {
                    container.innerHTML = '<li class="p-4 text-center text-gray-500">No upcoming appointments</li>';
                    return;
                }
                
                container.innerHTML = appointments.map(appt => `
                    <li class="p-4 hover:bg-gray-50 smooth-transition">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 ${getAppointmentColorClass(appt)} rounded-lg p-3">
                                <i class="${getAppointmentIcon(appt)} ${getAppointmentTextColor(appt)}"></i>
                            </div>
                            <div class="ml-4 flex-1">
                                <div class="flex items-center justify-between">
                                    <h4 class="text-sm font-medium text-gray-900">${appt.serviceName} with ${appt.clientName}</h4>
                                    <span class="text-xs ${getStatusBadgeClass(appt)} px-2 py-1 rounded-full">
                                        ${appt.status}
                                    </span>
                                </div>
                                <div class="mt-1 flex items-center text-sm text-gray-500">
                                    <i class="far fa-clock mr-1"></i>
                                    <span>${formatAppointmentDate(appt.startTime)} - ${formatTime(appt.endTime)}</span>
                                </div>
                            </div>
                        </div>
                    </li>
                `).join('');
            } catch (error) {
                console.error('Error loading upcoming appointments:', error);
                document.getElementById('upcoming-appointments').innerHTML = 
                    '<li class="p-4 text-center text-gray-500">Error loading appointments</li>';
            }
        }

        // Helper functions for appointments
        function getAppointmentColorClass(appt) {
            const status = appt.status.toLowerCase();
            if (status === 'confirmed') return 'bg-green-100';
            if (status === 'pending') return 'bg-blue-100';
            if (status === 'cancelled') return 'bg-red-100';
            if (status === 'completed') return 'bg-purple-100';
            return 'bg-gray-100';
        }

        function getAppointmentTextColor(appt) {
            const status = appt.status.toLowerCase();
            if (status === 'confirmed') return 'text-green-600';
            if (status === 'pending') return 'text-blue-600';
            if (status === 'cancelled') return 'text-red-600';
            if (status === 'completed') return 'text-purple-600';
            return 'text-gray-600';
        }

        function getAppointmentIcon(appt) {
            const serviceType = appt.serviceName.toLowerCase();
            if (serviceType.includes('consultation')) return 'fas fa-calendar-day';
            if (serviceType.includes('video')) return 'fas fa-video';
            if (serviceType.includes('call') || serviceType.includes('phone')) return 'fas fa-phone-alt';
            if (serviceType.includes('code')) return 'fas fa-laptop-code';
            return 'fas fa-calendar-check';
        }

        function getStatusBadgeClass(appt) {
            const status = appt.status.toLowerCase();
            if (status === 'confirmed') return 'bg-green-100 text-green-800';
            if (status === 'pending') return 'bg-blue-100 text-blue-800';
            if (status === 'cancelled') return 'bg-red-100 text-red-800';
            if (status === 'completed') return 'bg-purple-100 text-purple-800';
            return 'bg-gray-100 text-gray-800';
        }

        function formatAppointmentDate(dateTime) {
            const date = new Date(dateTime);
            const today = new Date();
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            if (date.toDateString() === today.toDateString()) {
                return `Today, ${formatTime(dateTime)}`;
            } else if (date.toDateString() === tomorrow.toDateString()) {
                return `Tomorrow, ${formatTime(dateTime)}`;
            } else {
                return `${date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })}, ${formatTime(dateTime)}`;
            }
        }

        // Load professional reviews
        async function loadProfessionalReviews() {
            try {
                const reviews = await reviewsAPI.getProfessionalReviews(1, { limit: 3 }); // TODO: Replace with actual professional ID
                
                const container = document.getElementById('recent-reviews');
                
                if (reviews.length === 0) {
                    container.innerHTML = '<li class="p-4 text-center text-gray-500">No reviews yet</li>';
                    return;
                }
                
                container.innerHTML = reviews.map(review => `
                    <li class="p-4 hover:bg-gray-50 smooth-transition">
                        <div class="flex items-start">
                            <div class="flex-shrink-0">
                                <img class="h-10 w-10 rounded-full" src="${review.client.profilePicture || 'https://via.placeholder.com/40'}" alt="">
                            </div>
                            <div class="ml-4 flex-1">
                                <div class="flex items-center justify-between">
                                    <h4 class="text-sm font-medium text-gray-900">${review.client.firstName} ${review.client.lastName}</h4>
                                    <div class="flex">
                                        ${renderStars(review.rating)}
                                    </div>
                                </div>
                                <div class="mt-1 text-sm text-gray-500">
                                    <p>${review.comments || 'No comments'}</p>
                                </div>
                                <div class="mt-2 text-xs text-gray-400">
                                    <i class="far fa-clock mr-1"></i> ${formatReviewDate(review.createdAt)}
                                </div>
                            </div>
                        </div>
                    </li>
                `).join('');
            } catch (error) {
                console.error('Error loading professional reviews:', error);
                document.getElementById('recent-reviews').innerHTML = 
                    '<li class="p-4 text-center text-gray-500">Error loading reviews</li>';
            }
        }

        function formatReviewDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffDays = Math.floor((now - date) / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) return 'Today';
            if (diffDays === 1) return 'Yesterday';
            if (diffDays < 7) return `${diffDays} days ago`;
            if (diffDays < 30) return `${Math.floor(diffDays / 7)} weeks ago`;
            return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
        }

        // Load professional services
        async function loadProfessionalServices() {
            try {
                const services = await professionalsAPI.getServices(1); // TODO: Replace with actual professional ID

                const container = document.getElementById('my-services');
                if (!services.length) {
                    container.innerHTML = '<li class="p-4 text-center text-gray-500">No services found</li>';
                    return;
                }

                container.innerHTML = services.map(service => `
                    <li class="p-4 hover:bg-gray-50 smooth-transition">
                        <div class="flex items-start justify-between">
                            <div>
                                <h4 class="text-sm font-medium text-gray-900">${service.Name}</h4>
                                <div class="mt-1 text-sm text-gray-500">
                                    <p>${service.Description || 'No description'}</p>
                                </div>
                                <div class="mt-2">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                        $${(service.Price ?? 0).toFixed(2)}/hour
                                    </span>
                                    <span class="ml-1 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                        ${service.BaseDuration} min base
                                    </span>
                                </div>
                            </div>
                        </div>
                    </li>
                `).join('');
            } catch (error) {
                console.error('Error loading services:', error);
                document.getElementById('my-services').innerHTML =
                    '<li class="p-4 text-center text-gray-500">Error loading services</li>';
            }
        }

        // Show toast notification
        function showToast(message, type = 'info') {
            // Simple implementation using alert - replace with a proper toast notification in production
            alert(`${type.toUpperCase()}: ${message}`);
        }
    </script>
</body>
</html>